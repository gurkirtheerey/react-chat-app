(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{133:function(e,t,r){},291:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(34),o=r.n(s),c=(r(133),r(3)),u=r.n(c),l=r(7),i=r(15),d=r(6),m=r(1),b=function(e){var t=e.roomText,r=e.setRoomText,n=e.create;return Object(m.jsxs)("div",{className:"flex justify-center mb-4",children:[Object(m.jsx)("input",{value:t,onChange:function(e){return r(e.target.value)},className:"px-4 py-2 rounded focus:outline-none text-gray-600 bg-gray-100",type:"text",placeholder:"Room name"}),Object(m.jsx)("button",{className:"ml-4 bg-red-600 px-2 w-28 rounded focus:outline-none hover:bg-red-700",onClick:n,children:"Enter"})]})},p=function(e){var t=e.sendMessage,r=e.text,n=e.setText;return Object(m.jsxs)("form",{onSubmit:function(e){return t(e)},className:"flex items-center justify-center pt-4",children:[Object(m.jsx)("input",{value:r,onChange:function(e){return n(e.target.value)},className:"w-1/2 p-4 rounded-lg outline-none border-0 text-gray-600",type:"text",placeholder:"Send message"}),Object(m.jsx)("button",{className:"p-4 bg-gray-400 rounded-lg ml-4 focus:outline-none hover:bg-gray-500 text-gray-700 hover:text-gray-300",children:"Send message"})]})},x=function(e){var t=e.message,r=(e.userId,e.user),n=Object(d.c)((function(e){return e.auth})).username;return Object(m.jsxs)("div",{id:"test",className:"px-4 py-2",children:[Object(m.jsx)("h2",{className:"font-bold ".concat(n===r?"text-red-400":"text-blue-200"),children:r}),Object(m.jsx)("span",{className:"text-gray-400",children:t})]})},j=function(e){var t,r=e.room,a=Object(n.useState)(0),s=Object(i.a)(a,2),o=s[0],c=s[1];return void 0!==r&&(t=r.messages),Object(n.useEffect)((function(){var e=document.getElementById("message-box");e&&(c(e.scrollHeight),e.scrollTop=o)}),[r,o]),Object(m.jsx)("div",{id:"message-box",className:"box-border h-3/5 overflow-scroll p-4 border-4 border-gray-500 rounded ml-4",children:t&&t.length?t.map((function(e){var t=e._id,r=e.userId,n=e.message,a=e.username;return Object(m.jsx)("ul",{children:Object(m.jsx)(x,{message:n,userId:r,user:a})},t)})):null})},f=function(e){var t=e.room,r=e.join;return Object(m.jsx)("div",{onClick:function(){return r(t)},className:"flex cursor-pointer hover:bg-gray-800 align-middle py-4 px-2 w-40 text-gray-300 text-sm",children:Object(m.jsx)("span",{className:"truncate ...",children:t.name})},String(t._id))},h=r(28),g=r(24),v=r(120),O=r.n(v).a.create({baseURL:"https://react-chatter-api.herokuapp.com/api"}),y={isLoggedIn:!1,userId:void 0,username:void 0,socketId:"",room:void 0,loading:!1},w=Object(h.b)({name:"auth",initialState:y,reducers:{saveUser:function(e,t){e.socketId=t.payload},setRoom:function(e,t){e.room=t.payload},setLoading:function(e,t){e.loading=t.payload},login:function(e,t){var r=t.payload,n=r.userId,a=r.username,s=r.token;e.isLoggedIn=!0,e.userId=n,e.username=a,e.loading=!1,localStorage.setItem("token",s)},register:function(e,t){var r=t.payload,n=r.userId,a=r.username,s=r.token;e.isLoggedIn=!0,e.userId=n,e.username=a,e.loading=!1,localStorage.setItem("token",s)},logout:function(e){e.isLoggedIn=!1,e.userId=void 0,e.username=void 0,localStorage.removeItem("token"),g.b.success("Successfully logged out!")},resetUser:function(e){e.isLoggedIn=!1,e.userId=void 0,e.username=void 0,localStorage.removeItem("token")},verify:function(e,t){var r=t.payload,n=r._id,a=r.username;e.isLoggedIn=!0,e.userId=n,e.username=a,e.loading=!1}}}),k=function(e,t){return function(){var r=Object(l.a)(u.a.mark((function r(n){var a,s;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n(C(!0)),r.next=4,O.post("/auth/login",{username:e,password:t});case 4:return a=r.sent,s=a.data,n(R(s)),r.abrupt("return",s);case 10:r.prev=10,r.t0=r.catch(0),n(C(!1)),g.b.error("Invalid username/password combination."),n(q()),console.log(r.t0);case 16:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e){return r.apply(this,arguments)}}()},N=function(e,t,r){return function(){var n=Object(l.a)(u.a.mark((function n(a){var s,o;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a(C(!0)),n.next=4,O.post("/auth/register",{email:e,username:t,password:r});case 4:return s=n.sent,o=s.data,a(B(o)),n.abrupt("return",o);case 10:n.prev=10,n.t0=n.catch(0),a(C(!1)),g.b.error(n.t0.response.data),a(q());case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},I=w.actions,S=(I.saveUser,I.setRoom),C=I.setLoading,R=I.login,B=I.register,L=I.logout,E=I.verify,q=I.resetUser,U=w.reducer,T=Object(h.b)({name:"room",initialState:{rooms:[]},reducers:{setRooms:function(e,t){e.rooms=t.payload}}}),M=T.actions.setRooms,_=T.reducer,P=r(121),A=Object(P.io)("https://react-chatter-api.herokuapp.com/",{transports:["websocket"]}),z=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),r=t[0],a=t[1],s=Object(n.useState)(""),o=Object(i.a)(s,2),c=o[0],x=o[1],h=Object(n.useState)(!1),v=Object(i.a)(h,2),y=v[0],w=v[1],k=Object(d.b)(),N=Object(d.c)((function(e){return e.auth})),I=N.room,C=N.userId,R=N.username,B=Object(d.c)((function(e){return e.room})).rooms;Object(n.useEffect)((function(){k(function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.get("/room");case 3:r=e.sent,n=r.data,t(M(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),A.on("update-messages",(function(e){return k(S(e))})),A.on("new-user-joined",function(){var e=Object(l.a)(u.a.mark((function e(t,r,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("".concat(t," has joined ").concat(r,"!")),g.b.success("".concat(t," has joined ").concat(r,"!")),null===n){e.next=5;break}return e.next=5,k(S(n));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),A.on("user-left",(function(e,t){console.log("".concat(t," has left ").concat(e,"...")),g.b.error("".concat(t," has left ").concat(e,"..."))}))}),[k]);var E=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a(""),A.emit("new-message",I,r,C,R);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){void 0!==I&&I.name!==e.name&&A.emit("leave-room",I,R),(null===I||void 0===I?void 0:I.name)!==e.name&&(k(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r){var n,a,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e._id,t.next=4,O.get("/room/get-room",{params:{_id:n}});case 4:a=t.sent,s=a.data,r(S(s)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(e)),A.emit("join-room",e,R))};return Object(m.jsxs)("div",{className:"bg-gray-700 flex",children:[Object(m.jsxs)("div",{className:"flex flex-col text-center align-middle relative overflow-hidden  border-r-2 border-black",children:[Object(m.jsx)("div",{className:"h-full",children:B&&B.length?B.map((function(e,t){return Object(m.jsx)(f,{room:e,join:q},e._id)})):null}),Object(m.jsx)("button",{className:"focus:outline-none bg-gray-600 w-32 self-center py-4 self-start text-xs rounded hover:bg-gray-800 mb-12 text-white font-bold",onClick:function(){return w(!y)},children:"Create Room"})]}),Object(m.jsxs)("div",{className:"bg-gray-700 h-screen text-white flex flex-col justify-center flex-1",children:[Object(m.jsx)("button",{className:"focus:outline-none bg-gray-600 font-semibold w-20 py-2 absolute right-0 top-0 text-xs rounded hover:bg-gray-800 mb-4 m-4",onClick:function(){k(L())},children:"Logout"}),y&&Object(m.jsx)(b,{roomText:c,setRoomText:x,create:function(){var e;c.length?(k((e=c,function(){var t=Object(l.a)(u.a.mark((function t(r){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.post("/room",{name:e});case 3:n=t.sent,a=n.data,r(M(a)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}())),w(!y)):alert("Please enter a name")}}),Object(m.jsx)(j,{room:I}),I&&Object(m.jsx)(p,{sendMessage:E,setText:a,text:r})]})]})},D=r(42),H=r(4),J=r(122),V=r.n(J),F=function(e){var t=e.loading;return Object(m.jsx)("div",{className:"flex justify-center items-center h-screen",children:Object(m.jsx)(V.a,{color:"red",loading:t,size:150})})},G=r(58),K=r(25),Q=(r(289),function(){var e=Object(d.b)(),t=Object(H.f)(),r=Object(d.c)((function(e){return e.auth})),a=r.isLoggedIn,s=r.loading,o=Object(n.useRef)(null);Object(n.useEffect)((function(){if(a)t.push("/");else{if(!o.current)return;o.current.focus()}}),[a,t]);var c=Object(G.a)({initialValues:{username:"",password:""},validationSchema:K.a({username:K.b().max(8,"Must be 8 characters or less").required("Required"),password:K.b().max(8,"Must be 8 characters or less").required("Required")}),onSubmit:function(){var r=Object(l.a)(u.a.mark((function r(n){var a,s;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n.username,s=n.password,r.next=3,e(k(a,s));case 3:void 0!==r.sent&&t.push("/");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()});return s?Object(m.jsx)(F,{loading:s}):Object(m.jsx)("form",{onSubmit:c.handleSubmit,className:"h-screen bg-red-100 flex justify-center items-center text-gray-500",children:Object(m.jsxs)("div",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col w-1/2 shadow-xl",children:[Object(m.jsxs)("div",{className:"mb-4",children:[Object(m.jsx)("h1",{className:"text-center font-semibold text-gray-700 text-xl mb-12",children:"Login"}),c.touched.username&&c.errors.username?Object(m.jsx)("span",{className:"text-red-500",children:c.errors.username}):null,Object(m.jsx)("label",{className:"block text-grey-darker text-sm font-bold mb-2",children:"Username"}),Object(m.jsx)("input",{onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.username,className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker",id:"username",type:"text",placeholder:"Username"})]}),Object(m.jsxs)("div",{className:"mb-6",children:[c.touched.password&&c.errors.password?Object(m.jsx)("span",{className:"text-red-500",children:c.errors.password}):null,Object(m.jsx)("label",{className:"block text-grey-darker text-sm font-bold mb-2",children:"Password"}),Object(m.jsx)("input",{onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.password,className:"shadow appearance-none border border-red rounded w-full py-2 px-3 text-grey-darker mb-3",id:"password",type:"password",placeholder:"******************"})]}),Object(m.jsxs)("div",{className:"flex items-center justify-between",children:[Object(m.jsx)("button",{className:"bg-red-400 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",type:"submit",children:"Sign in"}),Object(m.jsx)("span",{onClick:function(){return t.push("/register")},className:"font-bold text-sm cursor-pointer text-gray-400 hover:text-gray-500",children:"Don't have an account?"})]})]})})}),W=function(){var e=Object(d.b)(),t=Object(H.f)(),r=Object(d.c)((function(e){return e.auth})),a=r.isLoggedIn,s=r.loading,o=Object(n.useRef)(null),c=Object(G.a)({initialValues:{email:"",username:"",password:""},validationSchema:K.a({email:K.b().email().max(30,"Email must be 30 characters or less").required("Required"),username:K.b().max(8,"Must be 8 characters or less").required("Required"),password:K.b().max(8,"Must be 8 characters or less").required("Required")}),onSubmit:function(){var r=Object(l.a)(u.a.mark((function r(n){var a,s,o;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n.email,s=n.username,o=n.password,r.next=3,e(N(a,s,o));case 3:void 0!==r.sent&&t.push("/");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()});return Object(n.useEffect)((function(){if(a)t.push("/");else{if(!o.current)return;o.current.focus()}}),[a,t]),s?Object(m.jsx)(F,{loading:s}):Object(m.jsx)("form",{onSubmit:c.handleSubmit,className:"h-screen bg-red-100 flex justify-center items-center text-gray-500",children:Object(m.jsxs)("div",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col w-1/2 shadow-xl",children:[Object(m.jsxs)("div",{className:"mb-4",children:[Object(m.jsx)("h1",{className:"text-center font-semibold text-gray-700 text-xl mb-12",children:"Register"}),c.touched.email&&c.errors.email?Object(m.jsxs)("span",{className:"text-red-500",children:[c.errors.email,"!"]}):null,Object(m.jsx)("label",{className:"block text-grey-darker text-sm font-bold mb-2",children:"Email"}),Object(m.jsx)("input",{ref:o,onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.email,className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker mb-3",id:"email",type:"text",placeholder:"Email"}),c.touched.username&&c.errors.username?Object(m.jsx)("span",{className:"text-red-500",children:c.errors.username}):null,Object(m.jsx)("label",{className:"block text-grey-darker text-sm font-bold mb-2",children:"Username"}),Object(m.jsx)("input",{onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.username,className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker",id:"username",type:"text",placeholder:"Username"})]}),Object(m.jsxs)("div",{className:"mb-6",children:[c.touched.password&&c.errors.password?Object(m.jsx)("span",{className:"text-red-500",children:c.errors.password}):null,Object(m.jsx)("label",{className:"block text-grey-darker text-sm font-bold mb-2",children:"Password"}),Object(m.jsx)("input",{onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.password,className:"shadow appearance-none border border-red rounded w-full py-2 px-3 text-grey-darker mb-3",id:"password",type:"password",placeholder:"******************"})]}),Object(m.jsxs)("div",{className:"flex items-center justify-between",children:[Object(m.jsx)("button",{className:"bg-red-400 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",type:"submit",children:"Sign Up"}),Object(m.jsx)("span",{onClick:function(){return t.push("/login")},className:"font-bold text-sm cursor-pointer text-gray-400 hover:text-gray-500",children:"Have an account?"})]})]})})},X=r(44),Y=r(128),Z=function(e){var t=e.component,r=(e.user,Object(Y.a)(e,["component","user"])),n=Object(d.c)((function(e){return e.auth.isLoggedIn}));return Object(m.jsx)(H.b,Object(X.a)(Object(X.a)({},r),{},{render:function(e){return n?Object(m.jsx)(t,Object(X.a)(Object(X.a)({},r),e)):Object(m.jsx)(H.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},$=function(){return Object(m.jsx)(g.a,{position:"top-right",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,pauseOnFocusLoss:!1})},ee=function(){var e=Object(d.b)();return Object(n.useEffect)((function(){var t=localStorage.getItem("token");t&&e(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.get("/auth/verify",{headers:{Authorization:"".concat(e)}});case 3:n=t.sent,(a=n.data)&&r(E(a)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(t))}),[e]),Object(m.jsxs)(D.a,{children:[Object(m.jsx)($,{}),Object(m.jsx)(H.b,{exact:!0,path:"/login",component:Q}),Object(m.jsx)(H.b,{exact:!0,path:"/register",component:W}),Object(m.jsx)(Z,{exact:!0,path:"/",component:z})]})},te=Object(h.b)({name:"counter",initialState:{value:0},reducers:{increment:function(e){e.value+=1},decrement:function(e){e.value-=1},incrementByAmount:function(e,t){e.value+=t.payload}}}),re=te.actions,ne=(re.increment,re.decrement,re.incrementByAmount,te.reducer),ae=Object(h.a)({reducer:{counter:ne,auth:U,room:_}});o.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(d.a,{store:ae,children:Object(m.jsx)(ee,{})})}),document.getElementById("root"))}},[[291,1,2]]]);
//# sourceMappingURL=main.b056872f.chunk.js.map